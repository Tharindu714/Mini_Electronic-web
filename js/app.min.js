
$(function () {
  // Admin Panel settings

  //****************************
  /* This is for the mini-sidebar if width is less then 1170*/
  //****************************
  var setsidebartype = function () {
    var width =
      window.innerWidth > 0 ? window.innerWidth : this.screen.width;
    if (width < 1199) {
      $("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
      $("#main-wrapper").addClass("mini-sidebar");
    } else {
      $("#main-wrapper").attr("data-sidebartype", "full");
      $("#main-wrapper").removeClass("mini-sidebar");
    }
  };
  $(window).ready(setsidebartype);
  $(window).on("resize", setsidebartype);
  //****************************
  /* This is for sidebartoggler*/
  //****************************
  $(".sidebartoggler").on("click", function () {
    $("#main-wrapper").toggleClass("mini-sidebar");
    if ($("#main-wrapper").hasClass("mini-sidebar")) {
      $(".sidebartoggler").prop("checked", !0);
      $("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
    } else {
      $(".sidebartoggler").prop("checked", !1);
      $("#main-wrapper").attr("data-sidebartype", "full");
    }
  });
  $(".sidebartoggler").on("click", function () {
    $("#main-wrapper").toggleClass("show-sidebar");
  });
})


function approve(fid) {
  var request = new XMLHttpRequest();

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      var txt = request.responseText;
      if (txt == "Approved") {
        window.location.reload();
        document.getElementById("UB" + fid).innerHTML = '<img src="../images/backgrounds/check-mark-transparent-gif-13.png" width="40">';
      } else {
        alert(txt);
      }
    }
  };

  request.open("GET", "approveprocess.php?fid=" + fid, true);
  request.send();
}

function blockProduct(id) {

  var request = new XMLHttpRequest();

  request.onreadystatechange = function () {
      if (request.readyState == 4) {
          var txt = request.responseText;
          if (txt == "unblocked") {
              document.getElementById("pb" + id).innerHTML = '<img src="../images/backgrounds/check-mark-transparent-gif-13.png" width="40">';
          } else if (txt == "blocked") {
              document.getElementById("pb" + id).innerHTML = '<img src="../images/backgrounds/uncheck-mark-transparent-gif-13.png" width="40">';
          } else {
              alert(txt);
          }
      }
  }

  request.open("GET", "productBlockProcess.php?id=" + id, true);
  request.send();

}

function blockUser(email) {
  var req = new XMLHttpRequest();

  req.onreadystatechange = function () {
      if (req.readyState == 4) {
          var txt = req.responseText;
          if (txt == "Blocked") {
              document.getElementById("UB" + email).innerHTML = '<img src="../images/backgrounds/check-mark-transparent-gif-13.png" width="40">';
          } else if (txt == "UnBlocked") {
              document.getElementById("UB" + email).innerHTML = '<img src="../images/backgrounds/uncheck-mark-transparent-gif-13.png" width="40">';
          } else {
              alert(txt);
          }
      }
  }

  req.open("GET", "UserBlockProcess.php?email=" + email, true);
  req.send();
}

function loadChart() {
  var ctx = document.getElementById("myChart");
  var request = new XMLHttpRequest();
  request.onreadystatechange = function () {
    if ((request.readyState == 4) & (request.status == 200)) {
      var response = request.responseText;
      
      var data = JSON.parse(response);
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: data.labels,
          datasets: [{
            label: '# of Votes',
            data: data.data,
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }
  };
  request.open("POST", "../loadChartProcess.php", true);
  request.send();
}